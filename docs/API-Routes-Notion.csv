Route,Methods,Description,Tags,Status
/accept-invite,POST,"🔐 APA-HARDENED ROUTE: POST /api/accept-invite Purpose: - Accepts an invite using the provided invite code - Adds the current user to the cliq - Marks the invite as used - Handles different invite types (adult vs child) Body Params: - inviteCode: string (required) Returns: - 200 OK with cliqId if successful - 400 if no code is provided - 401 if user is not authenticated - 404 if invite is not found - 410 if invite is already used or expired Security: - Requires user authentication - For child invites, requires adult verification - Enforces APA-compliant access control","APA-Hardened, Auth-Required, Write",Active
/admin/force-password-reset,POST,Admin API to force password reset for a user POST /api/admin/force-password-reset,"APA-Hardened, Auth-Required, Write",Active
/auth/refresh-session,GET,🔄 APA-COMPLIANT SESSION REFRESH ENDPOINT,"Auth-Required, Read",Active
/auth/request-reset,POST,Allow 1 reset request per 10 minutes per email,Write,Active
/auth/status,GET,🔐 APA-HARDENED FALLBACK ROUTE: GET /api/auth/status,"APA-Hardened, Auth-Required, Read",Active
/auth/submit-reset,POST,Audit log,Write,Active
/cliqs/create,POST,🔐 APA-HARDENED ROUTE: POST /api/cliqs/create Purpose: - Creates a new cliq for the authenticated user - Adds the creator to the cliq's membership Auth: - Requires valid session (user.id) Body: - name: string - description?: string - privacy: 'private' | 'semi' | 'public' - coverImage?: string (optional; uses default if blank) Returns: - 200 OK + new cliq - 401 if unauthorized - 400 if invalid input - 500 on error,"APA-Hardened, Auth-Required, Write",Active
/cliqs/feed,GET,"🔐 APA-HARDENED ROUTE: GET /api/cliqs/feed?id={cliqId} Purpose: - Returns all active (non-expired) posts and their replies for a specific cliq - Requires that the requester is a member of the cliq Auth: - Validates session with getCurrentUser - Confirms user is a member of the cliq via the membership table Query Params: - id: string (cliqId) — required Output: - Array of posts ordered by `createdAt DESC` - Each post includes: - Author username - Replies ordered ASC - Reply author usernames Notes: - Posts are filtered to only include those with future `expiresAt` - This route intentionally uses query params instead of file-based [id] to avoid Next.js type shadowing bugs Completion: ✅ APA-safe and production-ready as of June 30, 2025","APA-Hardened, Auth-Required, Read",Active
/cliqs,GET,🔐 APA-HARDENED ROUTE: GET /api/cliqs?id={cliqId} Purpose: - Returns public info about a cliq based on the query parameter - Used when viewing cliq details safely without revealing private data Auth: - Requires user to be logged in - Requires user to be a member of the cliq Query Param: - id: string (cliq ID) Returns: - 200 OK with cliq summary info - 401 if unauthenticated or missing cliq ID - 403 if user is not a member of the cliq - 404 if cliq does not exist - 500 on server error,"APA-Hardened, Auth-Required, Read",Active
/cliqs/[id]/member-actions,Unknown,"🔐 APA-HARDENED ROUTE: POST /api/cliqs/[id]/member-actions Purpose: - Allows a user (with proper permissions) to remove, promote, or demote a member. Auth: - Uses getCurrentUser() for session validation - Requires user to be a member of the cliq Body Input: { targetUserId: string, action: 'remove' | 'promote' | 'demote' } Returns: - 200 OK on success - 401 if unauthenticated - 403 if not a member - 400 if invalid input - 500 on DB/server error","APA-Hardened, Auth-Required",Active
/cliqs/[id]/members,GET,🔐 APA-HARDENED ROUTE: GET /api/cliqs/[id]/members Purpose: - Returns all members of a cliq (with email + profile) Auth: - Requires user to be a member of the cliq,"APA-Hardened, Auth-Required, Read",Active
/cliqs/[id],"GET, DELETE, PATCH","🔐 APA-HARDENED ROUTE: GET, PATCH, DELETE /api/cliqs/[id] Purpose: - GET: Fetch cliq metadata (requires membership) - PATCH: Update cliq info (owner only) - DELETE: Soft-delete cliq (owner only) Auth: - All methods use getCurrentUser() - PATCH/DELETE restricted to cliq owner","APA-Hardened, Auth-Required, Read, Write, Delete",Active
/complete-approval,POST,"now supports: 'free', 'paid', 'ebt'",Write,Active
/create-checkout-session,POST,Check if Stripe secret key is available,Write,Active
/create-setup-intent,POST,📦 Stripe SetupIntent API — used for adding payment methods,"Auth-Required, Write",Active
/dev-reset,GET,No description available,Read,Active
/get-child-info,POST,Check if Stripe secret key is available,"Auth-Required, Write",Active
/invite/create,POST,🔐 APA-HARDENED — Invite Email Sender & Creator,"APA-Hardened, Auth-Required, Write",Active
/invite-request/approve,POST,"🔐 APA-HARDENED ROUTE: POST /api/invite-request/approve Purpose: - Allows a verified parent or adult to approve a pending invite request (usually submitted by a child user or system-initiated invite) Features: - Authenticates the current user - Ensures only adults (non-child profiles) can approve - Fetches the original inviteRequest by ID - Creates a new invite with `isApproved: true` - Deletes the original pending request Used In: - Parent HQ or email approval flow for child invites - Admin dashboard (future: moderation review tools) Related Routes: - /api/invite/create → creates invite or inviteRequest depending on role - /api/validate-invite → used during sign-up Completion: ✅ Fully live and APA-compliant as of June 30, 2025","APA-Hardened, Auth-Required, Write",Active
/invites/validate,GET,⚠️ DEPRECATED ROUTE: /api/invites/validate This route is deprecated. Please use /api/validate-invite instead. Purpose: - Legacy invite code validation (DEPRECATED) - Use /api/validate-invite for new implementations @deprecated Use /api/validate-invite instead,Read,Deprecated
/parent/approval-complete,POST,🔐 APA-HARDENED ROUTE: POST /api/parent/approval-complete,"APA-Hardened, Write",Active
/parent/child/reset-credentials,POST,POST /api/parent/child/reset-credentials,"Auth-Required, Write",Active
/parent/child/suspend,POST,POST /api/parent/child/suspend,"Auth-Required, Write",Active
/parent/child-credentials/update,POST,🔐 APA-HARDENED ROUTE: POST /api/parent/child-credentials/update Purpose: - Allows a parent to set up or update their child's username and password - Part of the APA-compliant flow where parents must create credentials for children - Updates both the user profile (username) and user auth (password) Body Params: - childId: string (required) - The ID of the child user - username: string (required) - The new username for the child - password: string (required) - The new password for the child Returns: - 200 OK if credentials updated successfully - 400 if missing required params - 403 if not authorized (not parent of this child) - 404 if child not found - 500 if server error,"APA-Hardened, Auth-Required, Write",Active
/parent/children,GET,"🔐 APA-HARDENED ROUTE: GET /api/parent/children Purpose: - Returns all child profiles linked to the currently authenticated parent - Used to populate the dropdown in ParentDashboard Auth: - Requires a logged-in parent user (validated via email) - Matches children via ParentLink table (email ↔ childId) Returns: - 200 OK with array of child profiles: [{ id, name?, email? }] - 401 if not authenticated - 500 on server error Used In: - ParentDashboard.tsx (child selector for ParentsHQPage)","APA-Hardened, Auth-Required, Read",Active
/parent/invite-request,GET,src/app/api/parent/invite-request/route.ts,"Auth-Required, Read",Active
/parent/pending-children,GET,GET /api/parent/pending-children,"Auth-Required, Read",Active
/parent/settings/update,POST,"🔐 APA-HARDENED ROUTE: POST /api/parent/settings/update Purpose: - Allows verified parents to update permissions and visibility settings for a specific child account they are linked to. Features: - Validates input using Zod - Ensures the parent is authenticated and linked to the child via ParentLink - Updates child settings in the profile table (e.g., invite ability, public cliqs, media access) Used In: - ParentsHQPage (toggle controls and visibility settings) - ParentDashboard wrapper (per-child management UI) Completion: ✅ Fully implemented and APA-compliant as of June 30, 2025","APA-Hardened, Auth-Required, Write",Active
/parent-approval/complete,POST,🔐 APA-HARDENED ROUTE: POST /api/parent-approval/complete Purpose: - Completes the parent approval process - Creates parent account if needed - Links parent to child account - Sets child account to approved - Applies test plan (no Stripe integration) Body Params: - inviteCode: string (required) - childId: string (required) - parentEmail: string (required) - password: string (required) Returns: - 200 OK if approval completed successfully - 400 if missing required params - 404 if invite not found - 500 if server error,"APA-Hardened, Write",Active
/parent-approval/request,"GET, POST",🔐 APA-HARDENED ROUTE: POST /api/parent-approval/request Purpose: - Handles child sign-up requests that require parent approval - Sends approval email to parent/guardian - Stores pending approval in database Body Params: - childFirstName: string (required) - childBirthdate: string (required) - parentEmail: string (required) Returns: - 200 OK if approval request sent successfully - 400 if missing required fields - 500 if server error Security: - No account created until parent approves - APA-compliant child protection flow,"APA-Hardened, Read, Write",Active
/parent-approval/validate,GET,🔐 APA-HARDENED ROUTE: GET /api/parent-approval/validate Purpose: - Validates parent approval request - Returns child information for preview Query Params: - inviteCode: string (required) - childId: string (required) Returns: - 200 OK with child info if valid - 400 if missing required params - 404 if invite not found - 500 if server error,"APA-Hardened, Read",Active
/posts/create,POST,"🔐 APA-HARDENED ROUTE: POST /api/posts/create Purpose: - Creates a new post inside a specific cliq - Supports optional image and text content - Sets default expiration at 90 days Auth: - Uses getCurrentUser() for session validation Input Body: { content?: string, image?: string (URL), cliqId: string } Returns: - 200 OK + new post - 401 if unauthenticated - 400 if invalid input or missing content - 500 on DB/server error","APA-Hardened, Auth-Required, Write",Active
/red-alert,POST,POST /api/red-alert,"Auth-Required, Write",Active
/replies,POST,🔐 APA-HARDENED — Create a reply to a post,"APA-Hardened, Auth-Required, Write",Active
/resend-verification,POST,Define validation schema,Write,Active
/reset-password,POST,🔐 APA-HARDENED RESET PASSWORD ENDPOINT,"APA-Hardened, Write",Active
/send-parent-email,POST,"🔐 APA-HARDENED ROUTE: POST /api/send-parent-email 🛠️ INTERNAL USE ONLY Purpose: - Sends parent approval emails for child account creation - Internal helper route for invite flow - Not intended for direct external API calls Tags: Internal, Helper, Email ⚠️ This is an internal helper route - use invite/create instead","APA-Hardened, Write",Active
/send-reset-email,POST,API route handler for sending password reset emails Uses the consolidated sendResetEmail helper from lib/auth,"APA-Hardened, Write",Active
/sign-in,POST,"🔐 APA-SAFE LOGIN ROUTE — FINAL VERSION Authenticates user with email/password, verifies child approval, issues secure session cookie via NextResponse headers. ✅ No persistent tokens used ✅ Role and approval validation ✅ Secure session-based auth only ✅ Legacy tokens cleared",Write,Active
/sign-out,POST,API Route for signing out users Clears auth_token cookie and any other session data,Write,Active
/sign-up,POST,🔐 APA-HARDENED — Sign-Up API Route,"APA-Hardened, Write",Active
/test-email,GET,Simple test endpoint to verify Resend API is working Access via: /api/test-email?email=your@email.com,Read,Active
/uploadthing,Unknown,No description available,,Active
/user/plan,POST,"API endpoint to save user's plan selection This is called from the choose-plan page For free/test plans, this directly updates the Account record For paid plans, this would normally redirect to Stripe","Auth-Required, Write",Active
/validate-invite,GET,"🔐 APA-HARDENED ROUTE: GET /api/validate-invite Purpose: - Validates an invite code provided in the query string - Confirms the invite exists, is still pending, and is not expired Query Params: - code: string (invite code to validate) Returns: - 200 OK with cliqId, invitedRole, inviterId if valid - 400 if no code is provided - 404 if invite is not found - 410 if invite is already used or expired Used In: - Sign-up and onboarding flow to validate invite links - Early access or referral systems (optional future use) Related Routes: - /api/invite/create → issues new invite codes - /api/invite-request/approve → enables parent approval before invite creation Completion: ✅ Fully live and APA-compliant as of June 30, 2025","APA-Hardened, Read",Active
/verify-email,GET,Email Verification API Endpoint Purpose: - Processes email verification tokens - Marks accounts as verified when users click verification links - Required verification (users must verify before accessing the app),Read,Active
/webhooks/stripe,POST,"Stripe Webhook API Route This webhook handler processes Stripe events, particularly focusing on payment success to automatically verify user accounts when they make a successful payment.",Write,Active
